use ahash::{HashSet, HashSetExt};
use crate::problems::commons::{CharGrid, Uquard};

pub fn part1(input: &str) -> usize {
    let mut grid = CharGrid::new(input);
    let mut running_count = 1;//starting position

    let guard_intial = grid.chars.iter().enumerate().find(|char| ['^','>','v','<'].contains(char.1)).unwrap();
    let mut guard_position = grid.vec_index_to_uquard(guard_intial.0);
    let mut guard_rotation = *guard_intial.1;
    let guard_index = guard_intial.0;
    grid.chars[guard_index] = 'X';

    'movemnet_loop:loop {
        let next_guard_postion = get_next_guard_position_mut(guard_position, guard_rotation, &mut grid);
        match next_guard_postion {
            None => break 'movemnet_loop,
            Some(next_guard) => {
                if next_guard.1 == &'#' {
                    guard_rotation = match guard_rotation {
                        '^' => '>',
                        '>' => 'v',
                        'v' => '<',
                        '<' => '^',
                        _ => unreachable!()
                    }
                } else {
                    guard_position = next_guard.0;
                    if next_guard.1 != &'X'{
                        *next_guard.1 = 'X';
                        running_count += 1;
                    }
                }
            }
        }
    }
    grid.debug_print();
    //assert_eq!(running_count, grid.chars.iter().filter(|c| **c == 'X').count());
    //println!("{:?}",grid.chars);
    running_count
}

pub fn part2(input: &str) -> usize {
    let mut grid = CharGrid::new(input);
    let mut running_count = 0;//starting position
    let mut hash_set_for_treversal_loops = Vec::with_capacity(80);

    let guard_intial = grid.chars.iter().enumerate().find(|char| ['^','>','v','<'].contains(char.1)).unwrap();
    let mut guard_position = grid.vec_index_to_uquard(guard_intial.0);
    let initial_guard_position = guard_position;
    let mut guard_rotation = *guard_intial.1;

    loop {
        let next_guard_postion = get_next_guard(guard_position, guard_rotation, &grid);
        match next_guard_postion {
            None => break,
            Some(next_guard) => {
                if next_guard.1 == '#' {
                    guard_rotation = rotate_90_cw(guard_rotation)
                } else {
                    //find if an obstruction here whould cause a loop
                    let test_rotation = guard_rotation;
                    let test_position = guard_position;
                    let barrier_position = next_guard.0;
                    let barrier_char = grid.index_mut(barrier_position).unwrap();
                    if (!(barrier_position == initial_guard_position))&& barrier_char != &'O'{
                        let old_char = *barrier_char;
                        *barrier_char = '#';
                        if traversal_loops(test_position, test_rotation, &grid, &mut hash_set_for_treversal_loops) {
                            let barrier_char = grid.index_mut(barrier_position).unwrap();
                            *barrier_char = 'O';
                            running_count += 1;
                        } else {
                            let barrier_char = grid.index_mut(barrier_position).unwrap();
                            *barrier_char = old_char;
                        }
                    }
                    guard_position = next_guard.0;
                }
            }
        }
    }
    // assert_eq!(grid.chars.iter().filter(|x|x==&&'O').count(), running_count);
    // assert_eq!(grid.index(Uquard(grid.bounds[0]-1, grid.bounds[1]-1)), Some(grid.chars.last().unwrap()));


    for postion_index in REF_TRUE_POSTIONS_CAUSE_FUCK_ME_WHERE_THE_PROBLEM_IS {
        if grid.chars[postion_index] != 'O'{grid.chars[postion_index] = 'N'}
    }
    for mut my_found_value in grid.chars.iter_mut().enumerate().filter(|x|x.1==&'O') {
        if !REF_TRUE_POSTIONS_CAUSE_FUCK_ME_WHERE_THE_PROBLEM_IS.contains(&my_found_value.0) {
            print!("E");
            *my_found_value.1 = 'E';
        }
    }
    grid.debug_print();
    running_count
}

static REF_TRUE_POSTIONS_CAUSE_FUCK_ME_WHERE_THE_PROBLEM_IS:[usize;2262] = [4346,4086,3306,3177,3189,3196,3197,3204,3207,3209,3471,4121,8021,8151,8411,8931,11011,11141,13090,13069,13064,10589,9159,7599,7469,6819,6689,6040,6041,6049,6053,6057,6059,6190,7880,8010,8140,8920,10090,10350,10348,10345,10342,10339,10336,10334,10333,10329,10320,10317,10315,10313,10312,10310,10304,10300,10299,8347,7697,6397,5489,5491,5492,5494,5500,5503,5506,5507,5511,5514,5515,5517,5520,5521,5529,5537,5539,5540,5543,5547,5551,5552,6202,8022,8152,8412,8797,8790,8788,8785,8776,8774,8769,8766,8761,8630,8110,7590,7460,6680,6550,6420,6160,6030,5900,5770,5510,5380,5120,4990,4860,4600,4470,4340,4080,3820,3300,3170,2521,2523,2524,2527,2530,2536,2539,3451,3581,3841,5011,5141,5531,7351,8001,8391,8781,9561,9691,10081,10341,10731,10991,11121,12031,13071,14491,14489,14485,12131,10571,9791,9531,9401,8621,7713,7716,7717,7721,7722,7723,7724,7725,7731,7865,7995,8125,8385,8515,8775,9295,9555,9685,9944,9943,9939,9936,9930,9925,9924,9923,9921,9920,9914,9910,9909,9907,9385,8475,7960,7964,7966,7968,7976,7977,7981,7982,7983,7984,7985,7986,7991,7995,7999,8001,8003,8005,8007,8008,8138,8398,8528,8788,8918,9698,9958,10088,10348,10998,11388,11518,11648,11640,11639,11636,11634,11633,11631,11629,11620,10579,9801,9804,9806,9810,9815,9816,9817,9821,9822,9825,9828,9830,9831,9837,9841,9843,9975,10235,10365,10755,11015,11145,11275,11405,11535,11665,12055,13095,13355,13485,14005,14004,14000,13988,13976,13973,13971,13969,13959,13954,13951,13950,13945,13937,9380,7950,6910,6390,5610,5350,5090,4960,4830,4440,4310,4182,4186,4187,4189,4191,4192,4194,4200,4203,4206,4207,4211,4213,4214,4217,4218,4219,4220,4225,4226,4229,4231,4236,4237,4240,4243,4376,5156,5546,6196,6586,8016,8146,8406,8536,8796,8926,9186,9180,9178,9175,9169,9164,9163,9159,9156,9150,9147,9145,9141,9140,9136,9134,9130,9129,9127,9125,9120,9119,9113,8979,8459,7809,7289,6639,6379,5079,4429,4299,4169,4039,3909,3911,3914,3915,3917,3918,3919,3922,3926,3927,3929,3931,3932,3934,3940,3943,3946,3947,3950,3951,3953,3954,3957,3958,3960,3965,3966,3969,3971,3976,3977,3979,3980,3983,3984,3985,3987,3989,3991,3992,3995,4004,4135,4395,5955,6215,6475,6989,6976,6970,6968,6963,6954,6952,6949,6946,6945,6942,6940,6939,6937,6935,6932,6926,6924,6920,6917,6393,5613,5353,5093,4963,4833,4443,4183,3923,3793,3533,3403,2753,2493,2363,2233,1716,1718,1721,1722,1724,1727,1728,1730,1733,1736,1737,1743,1744,1747,1755,1756,1757,1758,1759,1761,1762,1763,2153,2413,3453,3583,4233,4753,5013,5143,5533,5788,5787,5782,5777,5776,5775,5772,5770,5769,5767,5765,5763,5761,5501,5371,5241,5111,4981,4851,4591,4461,4201,3941,3811,3681,2771,2382,2383,2384,3034,3294,3424,3554,4204,4724,4984,5504,5764,5894,6024,6154,6414,6674,6934,7064,7974,8104,8364,8494,8884,9144,9401,9400,9396,9392,9390,9387,9385,9383,9380,9379,9374,8984,8854,8594,8464,8074,7944,7034,7035,7042,7044,7045,7048,7050,7052,7054,7056,7058,7064,7066,7067,7070,7071,7073,7074,7075,7076,7081,7084,7085,7087,7347,7997,8127,8387,8517,8777,9167,9297,9427,9557,9947,10077,10337,10727,10987,11117,11247,11377,11637,12027,12677,12806,12804,12803,12801,12799,12798,12795,12789,12785,12783,12781,12780,12257,12127,11217,10567,9787,9397,8877,8617,8487,7967,7707,7447,6667,6407,6278,6279,6281,6284,6286,6287,6290,6291,6293,6294,6295,6296,6297,6300,6301,6304,6305,6307,6308,6309,6311,6313,6317,6320,6321,6326,6327,6332,6333,6336,6338,6339,6340,6342,6345,6346,6349,6350,6480,7000,7520,7780,8430,8820,9340,9730,10250,10380,10770,11550,11680,13110,14278,14264,14260,13596,11388,11391,11397,11399,11401,11405,11413,11416,11546,11676,12066,12976,13106,13235,12061,11411,9591,9331,9201,6341,6211,5951,5821,5691,5172,5173,5175,5179,5180,5183,5966,6486,7006,7526,7786,8826,9346,9736,9866,10386,10776,10906,11556,11686,11946,12206,12463,12459,12455,12451,12445,12444,12443,12440,12436,11393,10743,10483,9833,9573,9183,8013,7886,7887,7892,7893,7896,7898,7899,7902,7903,7904,7910,7912,7916,7917,8048,8828,8958,9348,9478,9738,9868,10388,10778,10908,11298,11558,11688,11948,12208,12468,12988,13118,13248,13508,13503,13495,13491,13489,13485,13484,13483,13480,13476,13473,13468,13466,13460,13459,13458,13456,13325,12157,12161,12171,12179,12181,12185,12449,12969,13099,13489,14009,14269,14399,14529,15179,15176,15170,15166,15158,15156,15155,15149,15145,15144,15143,15142,15012,13712,13582,13322,12152,12022,11892,11372,11112,10722,9812,9552,9422,9162,8515,8517,8521,8523,8525,8528,8530,8531,8536,8537,8542,8543,8544,8546,8548,8549,8553,8554,8558,8818,9338,9728,10248,10378,10638,10768,11288,11548,11678,11938,12068,12198,12458,12978,13108,13238,13498,13625,13621,13619,13615,13614,13613,13611,13610,13606,13605,13603,13602,13601,13599,13598,13596,13590,13589,13588,13586,13585,13584,13582,13581,13579,13570,13569,13568,13566,13436,12526,12136,11356,10576,10189,10190,10194,10196,10200,10204,10205,10207,10211,10212,10215,10218,10220,10221,10223,10224,10227,10231,10233,10235,10236,10238,10239,10243,10248,10250,10252,10253,10383,10643,10773,10903,11293,11553,11683,11943,12203,12463,12853,12983,13113,13243,13503,14283,14543,15323,15318,14803,15708,15705,15701,15696,15690,15686,15685,15681,15680,15679,15676,15675,15154,15024,14634,14504,14244,13334,12814,12554,12424,12164,12034,11904,11514,11384,11124,10604,10214,9824,9564,9174,8524,8004,7874,7744,7484,7354,7224,6834,6836,6837,6838,6840,6841,6842,6844,6846,6847,6979,7369,8019,8149,8279,8539,8799,8929,9189,9319,9579,9839,9969,10229,10359,10619,10877,10876,10875,10873,10870,10868,10867,10864,10860,10859,10857,10856,10855,10854,10852,10851,10849,10846,10839,10836,10835,10834,10833,10831,10830,10827,10826,10565,10175,9915,9395,9135,8875,8745,8615,8485,7965,7705,7445,6665,6405,6015,5885,5755,5495,5365,5235,5105,4975,4845,4585,4455,4195,3935,3805,3546,3547,3548,3551,3552,3554,3555,3556,3557,3558,3560,3561,3563,3564,3566,3567,3568,3570,3575,3576,3577,3578,3579,3581,3583,3585,4235,4755,5015,5145,5535,5795,6055,6315,6965,7224,7223,7217,7214,7212,7209,7206,7205,7202,7200,7199,7197,7192,7190,7187,7185,7184,7180,7177,6655,6395,6005,5875,5615,5485,5355,5225,5095,4965,4835,4705,4706,4707,4709,4710,4711,4712,4717,4718,4721,4722,4724,4726,4727,4728,4730,4731,4733,4734,4735,4736,4737,4738,4739,4740,4741,4743,4744,4745,4746,4747,4748,4749,4751,4753,4755,4756,4757,4759,4760,4762,4763,4764,4766,4767,4771,4772,4774,4775,4780,4781,4907,4904,4899,4896,4895,4890,4889,4878,4877,4869,4867,4866,4865,4862,4860,4851,4845,4844,4842,4711,4581,4451,4191,3931,3801,3541,3411,3281,2761,2631,2501,2371,2241,1721,1591,1461,1201,1071,811,551,552,554,556,557,560,562,563,564,567,568,569,574,583,587,589,592,593,595,596,602,603,609,611,1263,1900,1890,1889,1888,1887,1884,1882,1878,1877,1871,1869,1725,1336,1337,1338,1340,1342,1343,1344,1346,1347,1348,1350,1353,1354,1360,1363,1364,1365,1366,1367,1369,1371,1372,1373,1375,1376,1380,1382,1383,1385,1389,1391,1393,1395,1399,1403,1404,1408,2191,3491,3608,3607,3597,3205,2685,2555,1905,1385,1125,995,865,869,871,873,875,880,883,884,886,888,891,896,2069,2199,3629,4409,5053,5052,5044,4784,4004,2834,2574,2444,2446,2448,2451,2456,2457,2459,2461,2462,2723,2983,3633,4413,4663,4662,4654,4651,4648,4647,4644,4639,4636,4635,4630,4629,4621,4619,4618,4617,4615,4612,4480,4220,3960,3830,3570,3180,2530,2400,2270,2271,2273,2274,2275,2276,2277,2278,2279,2281,2283,2284,2285,2286,2288,2290,2292,2293,2295,2296,2297,2299,2301,2302,2305,2566,2696,3216,3606,4126,4386,4906,6069,6066,6065,6064,5804,5544,5414,5154,4504,4506,4507,4509,4511,4512,4514,4516,4519,4520,4521,4522,4525,4528,4529,4530,4533,4536,4537,4539,4670,4930,5060,5840,5970,6490,7010,7270,7400,7530,7660,7790,8050,8830,8960,9350,9480,9740,9870,10128,10123,10111,10110,10109,10108,10105,9844,9584,9454,9324,9194,8544,8414,7894,7504,7244,6334,6074,5814,5684,5164,4514,4384,3994,3864,3866,3868,3871,3872,3874,3875,3876,3878,3879,3880,3884,4274,4664,5444,5574,5834,5964,6484,6742,6739,6734,6733,6731,6730,6729,6727,6726,6724,6716,6715,6714,6713,6322,6192,6062,5932,5802,5542,5412,5152,4502,4242,3982,3852,3592,3202,2812,2813,2815,2817,2819,2820,2821,3213,3603,4123,4903,5163,5293,5289,5286,5284,5282,5280,5279,5277,5271,5270,5269,5268,5267,5265,5262,5260,5259,5257,5256,5255,5253,5252,5250,5249,5118,4728,4598,4468,4208,3948,3818,3558,3298,3168,2908,2648,2518,2258,1738,1348,1218,1088,828,568,308,309,312,314,321,323,327,332,333,334,335,336,342,343,997,1647,1907,2037,2427,2557,2945,2944,2942,2941,2940,2938,2937,2931,2930,2929,2928,2927,2926,2925,2924,2922,2920,2918,2917,2913,2912,2910,2908,2907,2906,2901,2898,2895,2894,2891,2889,2888,2887,2886,2885,2883,2881,2880,2878,2877,2747,2487,2227,1317,1190,1714,1974,2494,2624,2884,3404,4184,4704,4834,4964,5224,5354,5614,5743,5740,5739,5738,5733,5472,5082,4822,4692,4562,4432,4302,4172,3912,3522,3392,3004,3005,3008,3011,3014,3016,3277,3276,3273,3271,3270,3268,3267,3266,3264,3004,2874,2744,2614,2484,2224,1964,1314,1184,1054,1055,1056,1836,1834,1833,1306,1176,786,139,145,149,150,158,161,162,293,683,943,1723,1853,1983,2373,2503,2633,2893,3023,3283,3413,3543,4193,4453,4843,4973,5233,5493,5623,5753,5883,6013,6273,6403,6663,7183,7313,7573,7703,7963,8093,8353,8483,8613,8873,9133,9393,9523,9913,10043,10303,10433,10563,10693,10953,11473,11993,12508,12507,12505,12503,12502,12242,12112,11852,11722,11462,9642,9649,9650,9653,9658,9922,10052,10312,10442,10572,10832,10962,11092,11482,11612,11872,12002,12522,12782,12912,13302,13431,13430,13429,13428,13427,13426,13425,13419,13029,12509,12379,12249,12119,11859,11729,11469,11339,11079,10690,10691,10693,10698,10702,10703,10709,10710,10711,10712,10843,10973,11103,11233,11363,11623,11883,12013,12273,12403,12533,12793,12923,13053,13313,13573,13963,14093,14483,14613,15003,15133,15523,15653,16043,16303,16430,16429,16428,16426,16424,16422,16419,16418,16417,16416,16407,16406,16405,16402,16392,16387,15215,13265,13005,12747,12754,13668,14578,14708,15098,15488,15482,15479,15478,15477,15475,15474,15214,14564,13264,13004,12744,12224,12094,11964,11444,11314,11054,10404,10274,9624,9494,9234,8974,8584,8064,7804,7545,7546,7549,7554,7555,7562,7565,7698,7958,8088,8478,8608,8738,8868,9128,9388,9648,9908,10038,10298,10428,10558,10688,10818,10948,11208,11338,11468,11598,11988,12248,12247,12245,12242,12240,12238,12232,12231,12228,12226,12224,12223,12222,12221,12091,11961,11441,11051,10401,10271,9621,9491,9231,9101,8971,8841,8581,8321,8195,8197,8199,8204,8205,8211,8212,8215,8218,8220,8221,8223,8228,8232,8234,8235,8236,8237,8238,8240,8241,8242,8243,8244,8245,8246,8251,8255,8257,8518,8778,9168,9298,9428,9558,9818,9948,10338,10468,10598,10858,10988,11118,11248,11378,11638,11898,12288,12418,12548,12678,12808,13068,13588,13978,14238,14236,14235,14234,14232,14231,14230,14229,14225,14220,14219,14218,14216,14215,14214,14211,14210,14209,14208,14207,14206,14205,14204,13814,13684,13424,13034,12514,12384,12254,12124,11998,12002,12003,12008,12009,12010,12011,12013,12014,12274,12404,12534,12794,12924,13054,13314,13574,13964,14224,14484,14614,14870,14869,14868,14867,14866,14865,14864,14473,14213,13823,13693,13563,13433,13173,13174,13179,13180,13181,13184,13190,13192,13196,13198,13199,13201,13204,13206,13597,13987,14247,14377,14507,14897,15157,15417,15677,15807,15937,16067,16197,16196,16194,16189,16188,16187,16186,16185,16184,16183,16182,16181,16180,16179,16178,16175,16172,15912,15522,15262,14482,14222,13832,13572,13182,12792,12532,12402,12272,12012,11882,11492,11362,11102,10712,10582,10192,9802,9542,9412,9152,9022,9023,9024,9025,9026,9030,9032,9035,9038,9039,9041,9042,9044,9045,9048,9050,9051,9053,9054,9056,9057,9059,9061,9064,9065,9066,9068,9069,9073,9076,9078,9080,9081,9341,9731,10251,10381,10641,10771,10901,11291,11551,11681,11806,11803,11801,11800,11799,11798,11795,11794,11793,11790,11398,10878,10748,10618,10488,10228,9838,9578,9448,9318,9058,8538,8408,8278,7888,7758,7498,7238,6328,6068,5938,5808,5548,5158,4508,4378,3988,3858,3598,3208,2818,2688,2558,2298,2168,1908,1779,1780,1781,1783,1784,1785,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1801,1804,1806,1807,1809,1810,1811,1812,1813,1944,2074,2320,2319,2185,2055,1795,1405,1275,1145,885,625,365,235,];
static REF_CHECKED_POSITIONS:[usize;5533] = [4346,4216,4086,3956,3826,3696,3566,3436,3306,3176,3177,3178,3179,3180,3181,3182,3183,3184,3185,3186,3187,3188,3189,3190,3191,3192,3193,3194,3195,3196,3197,3198,3199,3200,3201,3202,3203,3204,3205,3206,3207,3208,3209,3210,3211,3341,3471,3601,3731,3861,3991,4121,4251,4381,4511,4641,4771,4901,5031,5161,5291,5421,5551,5681,5811,5941,6071,6201,6331,6461,6591,6721,6851,6981,7111,7241,7371,7501,7631,7761,7891,8021,8151,8281,8411,8541,8671,8801,8931,9061,9191,9321,9451,9581,9711,9841,9971,10101,10231,10361,10491,10621,10751,10881,11011,11141,11271,11401,11531,11661,11791,11921,12051,12181,12311,12441,12571,12701,12831,12961,13091,13090,13089,13088,13087,13086,13085,13084,13083,13082,13081,13080,13079,13078,13077,13076,13075,13074,13073,13072,13071,13070,13069,13068,13067,13066,13065,13064,13063,13062,13061,13060,13059,12929,12799,12669,12539,12409,12279,12149,12019,11889,11759,11629,11499,11369,11239,11109,10979,10849,10719,10589,10459,10329,10199,10069,9939,9809,9679,9549,9419,9289,9159,9029,8899,8769,8639,8509,8379,8249,8119,7989,7859,7729,7599,7469,7339,7209,7079,6949,6819,6689,6559,6429,6299,6169,6039,6040,6041,6042,6043,6044,6045,6046,6047,6048,6049,6050,6051,6052,6053,6054,6055,6056,6057,6058,6059,6060,6190,6320,6450,6580,6710,6840,6970,7100,7230,7360,7490,7620,7750,7880,8010,8140,8270,8400,8530,8660,8790,8920,9050,9180,9310,9440,9570,9700,9830,9960,10090,10220,10350,10349,10348,10347,10346,10345,10344,10343,10342,10341,10340,10339,10338,10337,10336,10335,10334,10333,10332,10331,10329,10328,10327,10326,10325,10324,10323,10322,10321,10320,10319,10318,10317,10316,10315,10314,10313,10312,10311,10310,10309,10308,10307,10306,10305,10304,10303,10302,10301,10300,10299,10298,10297,10167,10037,9907,9777,9647,9517,9387,9257,9127,8997,8867,8737,8607,8477,8347,8217,8087,7957,7827,7697,7567,7437,7307,7177,7047,6917,6787,6657,6527,6397,6267,6137,6007,5877,5747,5617,5487,5488,5489,5490,5491,5492,5493,5494,5495,5496,5497,5498,5499,5500,5501,5502,5503,5504,5505,5506,5507,5508,5509,5510,5511,5512,5513,5514,5515,5516,5517,5518,5519,5520,5521,5522,5523,5524,5525,5526,5527,5528,5529,5530,5531,5532,5533,5534,5535,5536,5537,5538,5539,5540,5541,5542,5543,5544,5545,5546,5547,5548,5549,5551,5552,5682,5812,5942,6072,6202,6332,6462,6592,6722,6852,6982,7112,7242,7372,7502,7632,7762,7892,8022,8152,8282,8412,8542,8672,8801,8800,8799,8798,8797,8796,8795,8794,8793,8792,8790,8789,8788,8787,8786,8785,8784,8783,8782,8781,8780,8779,8778,8777,8776,8775,8774,8773,8772,8771,8769,8768,8767,8766,8765,8764,8763,8762,8761,8760,8630,8500,8370,8240,8110,7980,7850,7720,7590,7460,7330,7200,7070,6940,6810,6680,6550,6420,6290,6160,6030,5900,5770,5510,5380,5250,5120,4990,4860,4730,4600,4470,4340,4210,4080,3950,3820,3690,3560,3430,3300,3170,3040,2910,2780,2650,2520,2521,2522,2523,2524,2525,2526,2527,2528,2529,2530,2531,2532,2533,2534,2535,2536,2537,2538,2539,2540,2541,2671,2801,2931,3191,3321,3451,3581,3711,3841,3971,4101,4231,4361,4491,4621,4751,4881,5011,5141,5271,5531,5661,5791,6051,6181,6311,6441,6571,6701,6831,6961,7091,7221,7351,7481,7611,7741,7871,8001,8131,8261,8391,8521,8781,8911,9041,9171,9301,9431,9561,9691,9821,9951,10081,10341,10471,10601,10731,10861,10991,11121,11251,11381,11511,11641,11771,11901,12031,12161,12291,12421,12551,12681,12811,13071,13201,13331,13461,13591,13721,13851,13981,14111,14241,14371,14501,14500,14499,14498,14497,14496,14495,14494,14493,14492,14491,14490,14489,14488,14487,14486,14485,14484,14483,14482,14481,14480,14479,14478,14477,14476,14475,14474,14473,14472,14471,14341,14211,14081,13951,13821,13691,13561,13431,13301,13171,13041,12911,12781,12651,12521,12391,12261,12131,12001,11871,11741,11611,11481,11351,11221,11091,10961,10831,10701,10571,10311,10181,10051,9921,9791,9661,9531,9401,9271,9141,9011,8881,8751,8621,8491,8361,8231,8101,7971,7841,7711,7712,7713,7714,7715,7716,7717,7718,7720,7721,7722,7723,7724,7725,7726,7727,7729,7730,7731,7732,7733,7734,7735,7865,7995,8125,8255,8385,8515,8775,8905,9035,9165,9295,9425,9555,9685,9815,9945,9944,9943,9942,9941,9939,9938,9937,9936,9935,9934,9933,9932,9931,9930,9929,9928,9927,9926,9925,9924,9923,9921,9920,9919,9918,9917,9916,9915,9914,9913,9912,9911,9910,9909,9907,9906,9905,9775,9645,9515,9385,9255,9125,8995,8865,8735,8605,8475,8345,8215,8085,7955,7957,7958,7959,7960,7961,7962,7963,7964,7965,7966,7967,7968,7969,7971,7972,7973,7974,7975,7976,7977,7978,7980,7981,7982,7983,7984,7985,7986,7987,7989,7990,7991,7992,7993,7995,7996,7997,7998,7999,8001,8002,8003,8004,8005,8006,8007,8008,8138,8268,8398,8528,8788,8918,9048,9178,9308,9438,9568,9698,9828,9958,10088,10348,10478,10608,10738,10868,10998,11128,11258,11388,11518,11648,11647,11646,11645,11644,11643,11641,11640,11639,11638,11637,11636,11635,11634,11633,11632,11631,11629,11628,11627,11626,11625,11624,11623,11622,11621,11620,11619,11489,11359,11229,11099,10969,10839,10709,10579,10319,10189,9929,9799,9800,9801,9802,9803,9804,9805,9806,9807,9809,9810,9811,9812,9813,9815,9816,9817,9818,9819,9821,9822,9823,9824,9825,9826,9828,9830,9831,9832,9833,9834,9835,9836,9837,9838,9839,9841,9842,9843,9844,9845,9975,10105,10235,10365,10495,10625,10755,10885,11015,11145,11275,11405,11535,11665,11795,11925,12055,12185,12315,12445,12575,12705,12835,12965,13095,13225,13355,13485,13615,13745,13875,14005,14004,14003,14002,14001,14000,13999,13998,13997,13996,13995,13994,13993,13992,13991,13990,13989,13988,13987,13986,13985,13984,13983,13981,13980,13979,13978,13977,13976,13975,13974,13973,13972,13971,13970,13969,13968,13967,13966,13965,13964,13963,13962,13961,13960,13959,13958,13957,13956,13955,13954,13953,13951,13950,13949,13948,13947,13946,13945,13944,13943,13942,13941,13940,13939,13938,13937,13936,13935,13934,13933,13932,13931,13930,13800,13670,13540,13410,13280,13150,13020,12890,12760,12630,12500,12370,12240,12110,11980,11850,11720,11590,11460,11330,11200,11070,10940,10810,10680,10550,10420,10290,10160,10030,9900,9770,9640,9510,9380,9250,9120,8990,8860,8730,8600,8470,8340,8210,8080,7950,7820,7690,7560,7430,7300,7170,7040,6910,6780,6650,6520,6390,6260,6130,6000,5870,5740,5610,5480,5350,5220,5090,4960,4830,4700,4570,4440,4310,4180,4181,4182,4183,4184,4185,4186,4187,4188,4189,4190,4191,4192,4193,4194,4195,4196,4197,4198,4199,4200,4201,4202,4203,4204,4205,4206,4207,4208,4210,4211,4212,4213,4214,4216,4217,4218,4219,4220,4221,4222,4223,4224,4225,4226,4227,4228,4229,4231,4232,4233,4234,4235,4236,4237,4238,4239,4240,4241,4242,4243,4244,4245,4246,4376,4506,4636,4766,4896,5026,5156,5286,5546,5676,5806,5936,6066,6196,6326,6456,6586,6716,6846,6976,7106,7236,7366,7496,7626,7756,7886,8016,8146,8276,8406,8536,8796,8926,9056,9186,9185,9184,9183,9182,9180,9178,9177,9176,9175,9174,9173,9171,9170,9169,9168,9167,9165,9164,9163,9162,9161,9159,9158,9157,9156,9155,9154,9153,9152,9151,9150,9149,9148,9147,9146,9145,9144,9143,9141,9140,9139,9138,9137,9136,9135,9134,9133,9132,9131,9130,9129,9127,9125,9124,9123,9122,9120,9119,9118,9117,9116,9115,9114,9113,9112,9111,9110,9109,8979,8849,8719,8589,8459,8329,8199,8069,7939,7809,7679,7549,7419,7289,7159,7029,6899,6769,6639,6509,6379,6249,6119,5989,5859,5729,5599,5469,5339,5209,5079,4949,4819,4689,4559,4429,4299,4169,4039,3909,3910,3911,3912,3913,3914,3915,3916,3917,3918,3919,3920,3921,3922,3923,3924,3925,3926,3927,3928,3929,3930,3931,3932,3933,3934,3935,3936,3937,3938,3939,3940,3941,3942,3943,3944,3945,3946,3947,3948,3950,3951,3952,3953,3954,3956,3957,3958,3959,3960,3961,3962,3963,3964,3965,3966,3967,3968,3969,3971,3972,3973,3974,3975,3976,3977,3978,3979,3980,3981,3982,3983,3984,3985,3986,3987,3988,3989,3991,3992,3993,3994,3995,3996,3997,3998,3999,4000,4001,4002,4003,4004,4005,4135,4265,4395,4525,4655,4785,4915,5045,5175,5305,5435,5565,5695,5825,5955,6085,6215,6345,6475,6605,6735,6865,6995,6994,6993,6992,6991,6990,6989,6988,6987,6986,6985,6984,6981,6980,6979,6978,6976,6975,6974,6973,6972,6970,6969,6968,6967,6966,6965,6964,6963,6961,6960,6959,6958,6957,6956,6955,6954,6953,6952,6951,6949,6948,6947,6946,6945,6944,6943,6942,6940,6939,6938,6937,6936,6935,6934,6933,6932,6931,6930,6929,6928,6927,6926,6925,6924,6923,6922,6921,6920,6919,6917,6916,6915,6914,6913,6783,6653,6523,6393,6263,6133,6003,5873,5743,5613,5483,5353,5223,5093,4963,4833,4703,4573,4443,4183,3923,3793,3663,3533,3403,3273,3143,3013,2883,2753,2623,2493,2363,2233,2103,1973,1843,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722,1723,1724,1725,1726,1727,1728,1729,1730,1731,1732,1733,1734,1735,1736,1737,1738,1739,1740,1741,1742,1743,1744,1745,1746,1747,1748,1749,1750,1751,1752,1753,1754,1755,1756,1757,1758,1759,1760,1761,1762,1763,1893,2023,2153,2283,2413,2543,2673,2803,2933,3193,3323,3453,3583,3713,3973,4233,4363,4493,4623,4753,4883,5013,5143,5273,5533,5663,5793,5791,5790,5789,5788,5787,5786,5785,5784,5783,5782,5781,5780,5779,5778,5777,5776,5775,5774,5773,5772,5770,5769,5768,5767,5766,5765,5764,5763,5762,5761,5501,5371,5241,5111,4981,4851,4721,4591,4461,4201,3941,3811,3681,3551,3421,3291,3161,3031,2901,2771,2641,2511,2381,2382,2383,2384,2514,2644,2774,2904,3034,3164,3294,3424,3554,3684,3944,4204,4334,4464,4594,4724,4854,4984,5114,5244,5504,5764,5894,6024,6154,6284,6414,6544,6674,6934,7064,7194,7324,7454,7714,7974,8104,8234,8364,8494,8624,8754,8884,9144,9274,9404,9403,9401,9400,9399,9398,9397,9396,9395,9394,9393,9392,9391,9390,9389,9387,9385,9384,9383,9382,9380,9379,9378,9377,9376,9375,9374,9114,8984,8854,8724,8594,8464,8334,8204,8074,7944,7814,7684,7554,7424,7294,7164,7034,7035,7036,7037,7038,7040,7041,7042,7043,7044,7045,7047,7048,7049,7050,7051,7052,7053,7054,7055,7056,7057,7058,7059,7060,7061,7062,7064,7065,7066,7067,7068,7070,7071,7072,7073,7074,7075,7076,7077,7079,7080,7081,7082,7083,7084,7085,7086,7087,7217,7347,7477,7607,7737,7997,8127,8257,8387,8517,8777,8907,9167,9297,9427,9557,9817,9947,10077,10337,10467,10597,10727,10857,10987,11117,11247,11377,11637,11767,11897,12027,12157,12287,12417,12547,12677,12807,12806,12805,12804,12803,12802,12801,12799,12798,12797,12796,12795,12794,12793,12792,12791,12790,12789,12788,12787,12786,12785,12784,12783,12781,12780,12779,12778,12777,12647,12517,12387,12257,12127,11997,11867,11737,11607,11477,11347,11217,11087,10957,10827,10697,10567,10307,10177,9917,9787,9657,9397,9137,9007,8877,8747,8617,8487,8357,8227,7967,7837,7707,7577,7447,7317,6927,6797,6667,6537,6407,6277,6278,6279,6280,6281,6282,6284,6285,6286,6287,6288,6290,6291,6292,6293,6294,6295,6296,6297,6299,6300,6301,6302,6303,6304,6305,6306,6307,6308,6309,6311,6312,6313,6314,6315,6316,6317,6318,6320,6321,6322,6323,6324,6326,6327,6328,6329,6332,6333,6334,6335,6336,6337,6338,6339,6340,6341,6342,6343,6345,6346,6347,6348,6349,6350,6480,6610,6740,6870,7000,7130,7260,7390,7520,7650,7780,7910,8040,8170,8300,8430,8560,8690,8820,8950,9080,9210,9340,9470,9600,9730,9860,9990,10120,10250,10380,10510,10640,10770,10900,11030,11160,11290,11420,11550,11680,11810,11940,12070,12200,12330,12460,12590,12720,12850,12980,13110,13240,13370,13500,13630,13760,13890,14020,14150,14280,14279,14278,14277,14276,14275,14274,14273,14272,14271,14270,14269,14268,14267,14266,14265,14264,14263,14262,14261,14260,14259,14258,14257,14256,14255,14254,14253,14252,14251,14250,14249,14248,14247,14246,13986,13856,13726,13596,13466,13336,13076,12946,12816,12686,12556,12426,12296,12166,12036,11906,11646,11516,11386,11388,11389,11390,11391,11392,11393,11394,11395,11396,11397,11398,11399,11401,11402,11403,11405,11406,11407,11408,11409,11410,11411,11412,11413,11414,11415,11416,11546,11676,11806,11936,12066,12196,12326,12456,12586,12716,12846,12976,13106,13236,13235,13234,13233,13232,13231,13101,12971,12841,12711,12581,12451,12321,12191,12061,11931,11801,11671,11411,11281,11151,11021,10891,10761,10631,10501,10371,10241,10111,9981,9851,9721,9591,9461,9331,9201,9071,8941,8811,8681,8551,8421,8291,8161,8031,7901,7771,7641,7511,7381,7251,6991,6861,6731,6601,6341,6211,6081,5951,5821,5691,5561,5431,5301,5171,5172,5173,5175,5176,5177,5178,5179,5180,5181,5182,5183,5184,5185,5186,5316,5446,5576,5706,5836,5966,6096,6226,6356,6486,6616,6746,6876,7006,7136,7266,7396,7526,7656,7786,7916,8046,8176,8306,8436,8566,8696,8826,8956,9086,9216,9346,9476,9606,9736,9866,9996,10126,10256,10386,10516,10646,10776,10906,11036,11166,11296,11426,11556,11686,11816,11946,12076,12206,12336,12466,12465,12464,12463,12462,12460,12459,12458,12456,12455,12454,12453,12451,12450,12449,12448,12447,12445,12444,12443,12441,12440,12439,12438,12437,12436,12435,12434,12433,12303,12173,12043,11913,11783,11653,11393,11263,11133,11003,10873,10743,10613,10483,10353,10223,10093,9833,9703,9573,9443,9183,9053,8793,8663,8533,8403,8273,8143,8013,7883,7884,7886,7887,7888,7889,7892,7893,7894,7895,7896,7897,7898,7899,7901,7902,7903,7904,7905,7906,7907,7908,7910,7911,7912,7913,7914,7916,7917,7918,8048,8178,8308,8438,8568,8698,8828,8958,9088,9218,9348,9478,9608,9738,9868,9998,10128,10258,10388,10518,10648,10778,10908,11038,11168,11298,11428,11558,11688,11818,11948,12078,12208,12338,12468,12598,12728,12858,12988,13118,13248,13378,13508,13507,13506,13505,13504,13503,13502,13500,13499,13498,13497,13496,13495,13494,13493,13492,13491,13490,13489,13488,13487,13485,13484,13483,13482,13481,13480,13479,13478,13477,13476,13475,13474,13473,13472,13471,13470,13469,13468,13466,13465,13464,13463,13461,13460,13459,13458,13457,13456,13455,13325,13065,12805,12675,12545,12415,12285,12155,12157,12158,12159,12161,12162,12163,12164,12166,12167,12168,12169,12170,12171,12173,12174,12175,12176,12177,12178,12179,12181,12182,12183,12185,12186,12187,12188,12189,12449,12579,12709,12839,12969,13099,13229,13489,13619,13749,13879,14009,14269,14399,14529,14659,14789,14919,15049,15179,15178,15177,15176,15175,15174,15173,15172,15171,15170,15169,15168,15167,15166,15165,15164,15163,15162,15161,15160,15159,15158,15157,15156,15155,15154,15153,15152,15151,15150,15149,15148,15147,15146,15145,15144,15143,15142,15012,14882,14752,14492,14362,14232,13972,13842,13712,13582,13452,13322,13062,12802,12672,12542,12412,12282,12152,12022,11892,11632,11502,11372,11242,11112,10982,10852,10722,10592,10332,10202,9812,9682,9552,9422,9162,9032,8772,8642,8512,8513,8515,8517,8518,8519,8521,8522,8523,8524,8525,8526,8528,8530,8531,8533,8534,8536,8537,8538,8539,8542,8543,8544,8545,8546,8547,8548,8549,8551,8552,8553,8554,8555,8556,8557,8558,8688,8818,8948,9078,9208,9338,9468,9598,9728,9858,9988,10118,10248,10378,10508,10638,10768,10898,11028,11158,11288,11418,11548,11678,11808,11938,12068,12198,12458,12588,12718,12848,12978,13108,13238,13498,13628,13627,13626,13625,13624,13623,13622,13621,13619,13618,13617,13615,13614,13613,13612,13611,13610,13609,13608,13607,13606,13605,13604,13603,13602,13601,13600,13599,13598,13596,13595,13594,13593,13591,13590,13589,13588,13587,13586,13585,13584,13582,13581,13580,13579,13578,13577,13576,13575,13574,13573,13572,13571,13570,13569,13568,13567,13566,13436,13306,13176,13046,12786,12656,12526,12396,12266,12136,12006,11876,11746,11616,11486,11356,11226,11096,10966,10836,10706,10576,10316,10186,10187,10189,10190,10191,10192,10193,10194,10195,10196,10197,10199,10200,10202,10203,10204,10205,10207,10208,10209,10211,10212,10213,10214,10215,10216,10218,10220,10221,10223,10224,10225,10226,10227,10228,10229,10231,10232,10233,10235,10236,10237,10238,10239,10241,10242,10243,10244,10245,10246,10248,10250,10251,10252,10253,10383,10513,10643,10773,10903,11033,11163,11293,11423,11553,11683,11813,11943,12073,12203,12463,12593,12723,12853,12983,13113,13243,13503,13633,13763,13893,14023,14153,14283,14413,14543,14673,14803,14933,15063,15193,15323,15322,15321,15320,15319,15318,15188,15058,14928,14798,14799,14800,14801,14803,14804,14805,14806,14807,14808,14809,14810,14811,14812,14942,15072,15202,15332,15462,15592,15722,15721,15720,15719,15718,15717,15716,15715,15714,15713,15712,15711,15710,15709,15708,15707,15706,15705,15704,15703,15702,15701,15700,15699,15698,15697,15696,15695,15694,15693,15692,15691,15690,15689,15688,15687,15686,15685,15684,15683,15682,15681,15680,15679,15678,15677,15676,15675,15674,15544,15414,15154,15024,14894,14764,14634,14504,14374,14244,13984,13854,13464,13334,13074,12944,12814,12684,12554,12424,12164,12034,11904,11644,11514,11384,11254,11124,10994,10864,10734,10604,10214,10084,9824,9694,9564,9434,9174,9044,8784,8524,8394,8264,8004,7874,7744,7614,7484,7354,7224,6964,6834,6835,6836,6837,6838,6840,6841,6842,6843,6844,6846,6847,6848,6979,7109,7239,7369,7499,7629,7889,8019,8149,8279,8539,8799,8929,9059,9189,9319,9449,9579,9839,9969,10229,10359,10489,10619,10749,10879,10878,10877,10876,10875,10873,10872,10871,10870,10868,10867,10866,10864,10863,10861,10860,10859,10857,10856,10855,10854,10852,10851,10849,10848,10847,10846,10845,10844,10843,10842,10841,10839,10838,10836,10835,10834,10833,10831,10830,10829,10827,10826,10825,10695,10565,10305,10175,9915,9785,9655,9395,9135,9005,8875,8745,8615,8485,8355,8225,7965,7835,7705,7575,7445,7315,6925,6795,6665,6535,6405,6275,6145,6015,5885,5755,5495,5365,5235,5105,4975,4845,4715,4585,4455,4195,3935,3805,3675,3545,3546,3547,3548,3549,3551,3552,3554,3555,3556,3557,3558,3560,3561,3562,3563,3564,3566,3567,3568,3569,3570,3571,3572,3573,3574,3575,3576,3577,3578,3579,3581,3583,3584,3585,3715,3975,4235,4365,4495,4625,4755,4885,5015,5145,5275,5535,5665,5795,6055,6315,6445,6575,6965,7095,7224,7223,7221,7220,7219,7217,7216,7215,7214,7213,7212,7211,7209,7208,7207,7206,7205,7204,7203,7202,7200,7199,7198,7197,7196,7194,7193,7192,7191,7190,7189,7187,7185,7184,7183,7182,7181,7180,7179,7177,7176,6915,6785,6655,6525,6395,6265,6135,6005,5875,5745,5615,5485,5355,5225,5095,4965,4835,4705,4706,4707,4708,4709,4710,4711,4712,4713,4715,4716,4717,4718,4719,4721,4722,4724,4725,4726,4727,4728,4730,4731,4732,4733,4734,4735,4736,4737,4738,4739,4740,4741,4742,4743,4744,4745,4746,4747,4748,4749,4751,4753,4755,4756,4757,4758,4759,4760,4761,4762,4763,4764,4766,4767,4768,4769,4771,4772,4773,4774,4775,4776,4777,4778,4779,4780,4781,4911,4910,4909,4908,4907,4906,4905,4904,4903,4901,4900,4899,4898,4896,4895,4894,4893,4892,4891,4890,4889,4888,4887,4885,4883,4881,4880,4879,4878,4877,4876,4875,4874,4873,4872,4871,4870,4869,4868,4867,4866,4865,4864,4863,4862,4860,4859,4858,4857,4856,4854,4853,4851,4850,4849,4848,4847,4845,4844,4843,4842,4711,4581,4451,4191,3931,3801,3671,3541,3411,3281,3151,3021,2891,2761,2631,2501,2371,2241,2111,1981,1721,1591,1461,1331,1201,1071,941,811,681,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,743,873,1003,1133,1263,1393,1523,1653,1783,1913,1912,1911,1910,1909,1908,1907,1906,1905,1904,1903,1902,1901,1900,1899,1898,1897,1896,1895,1893,1892,1891,1890,1889,1888,1887,1886,1885,1884,1883,1882,1881,1880,1879,1878,1877,1876,1875,1874,1873,1872,1871,1870,1869,1868,1867,1866,1865,1864,1863,1862,1861,1860,1859,1858,1857,1856,1725,1595,1465,1335,1336,1337,1338,1339,1340,1341,1342,1343,1344,1345,1346,1347,1348,1349,1350,1351,1352,1353,1354,1355,1356,1357,1358,1359,1360,1361,1362,1363,1364,1365,1366,1367,1368,1369,1370,1371,1372,1373,1374,1375,1376,1377,1378,1379,1380,1381,1382,1383,1384,1385,1386,1387,1388,1389,1390,1391,1393,1394,1395,1396,1397,1398,1399,1400,1401,1402,1403,1404,1405,1406,1407,1408,1409,1410,1411,1541,1671,1801,1931,2061,2191,2321,2451,2581,2711,2841,2971,3101,3231,3361,3491,3621,3620,3619,3618,3617,3616,3615,3614,3613,3612,3611,3610,3609,3608,3607,3606,3605,3604,3603,3601,3600,3599,3598,3597,3596,3595,3465,3205,3075,2945,2815,2685,2555,2425,2295,2165,1905,1775,1645,1385,1255,1125,995,865,866,867,868,869,870,871,873,874,875,876,877,878,879,880,881,882,883,884,885,886,887,888,889,890,891,892,893,894,895,896,897,898,899,1029,1159,1289,1419,1549,1679,1809,1939,2069,2199,2329,2459,2589,2719,2849,2979,3109,3239,3369,3499,3629,3759,3889,4019,4149,4279,4409,4539,4669,4799,4929,5059,5058,5057,5056,5055,5054,5053,5052,5051,5050,5049,5048,5047,5045,5044,4914,4784,4654,4524,4394,4264,4004,3874,3614,3484,3354,3224,3094,2964,2834,2704,2574,2444,2445,2446,2447,2448,2449,2451,2452,2453,2454,2455,2456,2457,2459,2460,2461,2462,2463,2593,2723,2853,2983,3113,3243,3373,3503,3633,3763,3893,4023,4153,4283,4413,4543,4673,4672,4671,4669,4668,4667,4666,4665,4664,4663,4662,4661,4660,4659,4658,4657,4654,4653,4652,4651,4650,4649,4648,4647,4646,4645,4644,4643,4641,4640,4639,4638,4636,4635,4634,4633,4632,4631,4630,4629,4628,4627,4625,4623,4621,4620,4619,4618,4617,4616,4615,4614,4613,4612,4611,4610,4480,4220,3960,3830,3570,3440,3180,3050,2920,2790,2530,2400,2270,2271,2272,2273,2274,2275,2276,2277,2278,2279,2280,2281,2283,2284,2285,2286,2287,2288,2289,2290,2291,2292,2293,2295,2296,2297,2298,2299,2300,2301,2302,2303,2304,2305,2306,2436,2566,2696,2826,2956,3086,3216,3346,3606,3736,3996,4126,4256,4386,4906,5036,5166,5296,5426,5556,5686,5816,5946,6076,6075,6074,6071,6070,6069,6068,6066,6065,6064,5934,5804,5544,5414,5284,5154,4634,4504,4506,4507,4508,4509,4511,4512,4513,4514,4516,4517,4518,4519,4520,4521,4522,4525,4526,4527,4528,4529,4530,4531,4532,4533,4534,4535,4536,4537,4539,4670,4800,4930,5060,5190,5320,5450,5580,5710,5840,5970,6100,6230,6360,6490,6620,6750,6880,7010,7140,7270,7400,7530,7660,7790,7920,8050,8180,8310,8440,8570,8700,8830,8960,9090,9220,9350,9480,9610,9740,9870,10000,10130,10128,10126,10125,10124,10123,10122,10120,10118,10117,10116,10115,10114,10113,10111,10110,10109,10108,10107,10105,10104,9844,9714,9584,9454,9324,9194,9064,8934,8804,8544,8414,8284,8154,7894,7764,7634,7504,7374,7244,6984,6854,6724,6594,6334,6074,5944,5814,5684,5554,5424,5294,5164,4514,4384,4254,3994,3864,3866,3867,3868,3869,3870,3871,3872,3874,3875,3876,3877,3878,3879,3880,3881,3882,3883,3884,4014,4144,4274,4664,4794,5184,5314,5444,5574,5704,5834,5964,6094,6224,6354,6484,6614,6744,6743,6742,6740,6739,6738,6737,6735,6734,6733,6731,6730,6729,6728,6727,6726,6724,6721,6720,6719,6718,6716,6715,6714,6713,6712,6582,6322,6192,6062,5932,5802,5542,5412,5282,5152,4632,4502,4242,3982,3852,3722,3592,3462,3202,3072,2942,2812,2813,2815,2816,2817,2818,2819,2820,2821,2822,2823,2953,3083,3213,3343,3603,3733,3993,4123,4253,4903,5033,5163,5293,5291,5290,5289,5288,5286,5284,5282,5281,5280,5279,5278,5277,5275,5273,5271,5270,5269,5268,5267,5266,5265,5264,5263,5262,5261,5260,5259,5258,5257,5256,5255,5254,5253,5252,5250,5249,5248,5118,4728,4598,4468,4208,3948,3818,3558,3428,3298,3168,3038,2908,2778,2648,2518,2388,2258,2128,1738,1608,1348,1218,1088,958,828,568,438,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,607,867,997,1127,1387,1517,1647,1907,2037,2297,2427,2557,2817,2947,2945,2944,2942,2941,2940,2939,2938,2937,2936,2935,2933,2931,2930,2929,2928,2927,2926,2925,2924,2923,2922,2920,2919,2918,2917,2916,2915,2914,2913,2912,2910,2908,2907,2906,2904,2903,2901,2900,2899,2898,2897,2896,2895,2894,2893,2891,2890,2889,2888,2887,2886,2885,2883,2882,2881,2880,2879,2878,2877,2747,2617,2487,2357,2227,2097,1967,1837,1707,1577,1447,1317,1187,1188,1189,1190,1191,1192,1193,1194,1324,1454,1714,1844,1974,2104,2234,2364,2494,2624,2884,3014,3144,3274,3404,3534,3664,3924,4184,4314,4444,4574,4704,4834,4964,5094,5224,5354,5484,5614,5743,5742,5740,5739,5738,5737,5736,5735,5734,5733,5732,5602,5472,5342,5212,5082,4952,4822,4692,4562,4432,4302,4172,3912,3782,3652,3522,3392,3262,3132,3002,3003,3004,3005,3006,3007,3008,3009,3010,3011,3014,3015,3016,3017,3147,3277,3276,3273,3272,3271,3270,3269,3268,3267,3266,3265,3264,3004,2874,2744,2614,2484,2354,2224,2094,1964,1834,1704,1574,1444,1314,1184,1054,1055,1056,1186,1316,1446,1576,1706,1836,1834,1833,1832,1831,1830,1829,1828,1827,1826,1696,1566,1436,1306,1176,1046,916,786,656,526,396,266,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,293,553,683,813,943,1073,1203,1333,1463,1723,1853,1983,2113,2243,2373,2503,2633,2893,3023,3153,3283,3413,3543,3673,3933,4193,4323,4453,4843,4973,5103,5233,5493,5623,5753,5883,6013,6143,6273,6403,6533,6663,7183,7313,7443,7573,7703,7963,8093,8223,8353,8483,8613,8743,8873,9133,9393,9523,9653,9913,10043,10303,10433,10563,10693,10823,10953,11083,11213,11343,11473,11603,11733,11863,11993,12123,12253,12383,12513,12512,12511,12510,12509,12508,12507,12506,12505,12504,12503,12502,12372,12242,12112,11982,11852,11722,11592,11462,11332,11202,11072,10942,10812,10682,10552,10422,10292,10162,10032,9902,9772,9642,9643,9645,9647,9648,9649,9650,9651,9653,9655,9657,9658,9659,9661,9662,9922,10052,10312,10442,10572,10832,10962,11092,11222,11352,11482,11612,11742,11872,12002,12132,12262,12392,12522,12782,12912,13042,13172,13302,13431,13430,13429,13428,13427,13426,13425,13424,13423,13422,13421,13420,13419,13289,13159,13029,12899,12769,12509,12379,12249,12119,11989,11859,11729,11599,11469,11339,11209,11079,10949,10819,10689,10690,10691,10693,10695,10697,10698,10699,10702,10703,10704,10706,10707,10709,10710,10711,10712,10843,10973,11103,11233,11363,11623,11753,11883,12013,12143,12273,12403,12533,12793,12923,13053,13183,13313,13573,13703,13963,14093,14223,14483,14613,14743,14873,15003,15133,15263,15393,15523,15653,15783,15913,16043,16173,16303,16433,16432,16431,16430,16429,16428,16427,16426,16425,16424,16423,16422,16421,16420,16419,16418,16417,16416,16415,16414,16413,16412,16411,16410,16409,16408,16407,16406,16405,16404,16403,16402,16401,16400,16399,16398,16397,16396,16395,16394,16393,16392,16391,16390,16389,16388,16387,16386,16385,16255,16125,15995,15865,15735,15605,15475,15345,15215,15085,14955,14825,14695,14565,14435,14305,14175,14045,13915,13785,13655,13525,13395,13265,13135,13005,12875,12745,12746,12747,12748,12749,12750,12751,12752,12753,12754,12755,12756,12757,12758,12888,13018,13148,13278,13408,13538,13668,13798,13928,14058,14188,14318,14448,14578,14708,14838,14968,15098,15228,15358,15488,15487,15486,15485,15484,15483,15482,15481,15480,15479,15478,15477,15475,15474,15344,15214,15084,14954,14824,14694,14564,14434,14304,14174,14044,13914,13784,13654,13524,13394,13264,13134,13004,12874,12744,12614,12484,12354,12224,12094,11964,11834,11704,11574,11444,11314,11184,11054,10924,10794,10664,10534,10404,10274,10144,10014,9884,9754,9624,9494,9364,9234,9104,8974,8844,8714,8584,8454,8324,8194,8064,7934,7804,7674,7544,7545,7546,7547,7549,7550,7551,7552,7554,7555,7556,7557,7558,7560,7561,7562,7563,7564,7565,7567,7568,7698,7958,8088,8218,8348,8478,8608,8738,8868,9128,9388,9648,9908,10038,10298,10428,10558,10688,10818,10948,11078,11208,11338,11468,11598,11728,11858,11988,12118,12248,12247,12246,12245,12244,12242,12240,12239,12238,12237,12236,12235,12234,12233,12232,12231,12230,12229,12228,12227,12226,12224,12223,12222,12221,12091,11961,11831,11701,11571,11441,11311,11181,11051,10921,10791,10661,10531,10401,10271,10141,10011,9881,9751,9621,9491,9361,9231,9101,8971,8841,8711,8581,8451,8321,8191,8192,8194,8195,8196,8197,8199,8200,8201,8202,8204,8205,8206,8207,8208,8210,8211,8212,8213,8215,8218,8219,8220,8221,8223,8225,8227,8228,8229,8231,8232,8234,8235,8236,8237,8238,8240,8241,8242,8243,8244,8245,8246,8247,8249,8250,8251,8252,8253,8255,8257,8258,8518,8778,8908,9168,9298,9428,9558,9818,9948,10338,10468,10598,10858,10988,11118,11248,11378,11638,11768,11898,12158,12288,12418,12548,12678,12808,13068,13198,13588,13718,13978,14108,14238,14237,14236,14235,14234,14232,14231,14230,14229,14228,14227,14226,14225,14223,14222,14221,14220,14219,14218,14217,14216,14215,14214,14213,14211,14210,14209,14208,14207,14206,14205,14204,13944,13814,13684,13424,13294,13164,13034,12904,12774,12644,12514,12384,12254,12124,11994,11995,11997,11998,11999,12002,12003,12004,12006,12007,12008,12009,12010,12011,12013,12014,12144,12274,12404,12534,12794,12924,13054,13184,13314,13574,13704,13964,14224,14484,14614,14744,14873,14872,14871,14870,14869,14868,14867,14866,14865,14864,14863,14733,14473,14213,13953,13823,13693,13563,13433,13303,13173,13174,13176,13177,13178,13179,13180,13181,13184,13185,13186,13187,13188,13189,13190,13192,13193,13195,13196,13198,13199,13201,13202,13204,13206,13207,13597,13727,13987,14247,14377,14507,14637,14767,14897,15157,15287,15417,15677,15807,15937,16067,16197,16196,16195,16194,16193,16192,16191,16190,16189,16188,16187,16186,16185,16184,16183,16182,16181,16180,16179,16178,16177,16176,16175,16173,16172,16042,15912,15782,15652,15522,15392,15262,15132,14872,14742,14482,14222,13962,13832,13572,13442,13182,13052,12792,12662,12532,12402,12272,12012,11882,11622,11492,11362,11232,11102,10712,10582,10192,9802,9672,9542,9412,9152,9022,9023,9024,9025,9026,9027,9029,9030,9032,9033,9035,9038,9039,9041,9042,9044,9045,9046,9048,9050,9051,9053,9054,9056,9057,9059,9061,9062,9064,9065,9066,9067,9068,9069,9071,9072,9073,9074,9075,9076,9078,9080,9081,9211,9341,9471,9601,9731,9861,10251,10381,10511,10641,10771,10901,11031,11161,11291,11421,11551,11681,11810,11808,11806,11805,11804,11803,11801,11800,11799,11798,11797,11795,11794,11793,11791,11790,11789,11788,11658,11398,11268,11138,10878,10748,10618,10488,10228,10098,9838,9708,9578,9448,9318,9058,8798,8538,8408,8278,8148,7888,7758,7628,7498,7368,7238,6718,6588,6328,6068,5938,5808,5548,5288,5158,4508,4378,4248,3988,3858,3598,3468,3208,3078,2818,2688,2558,2298,2168,1908,1778,1779,1780,1781,1783,1784,1785,1786,1787,1788,1789,1790,1791,1792,1793,1794,1795,1796,1797,1798,1799,1801,1802,1803,1804,1805,1806,1807,1809,1810,1811,1812,1813,1814,1944,2074,2204,2334,2333,2332,2331,2329,2328,2327,2326,2325,2324,2323,2321,2320,2319,2318,2317,2316,2315,2185,2055,1795,1665,1405,1275,1145,885,755,625,495,365,235,];


fn traversal_loops(position: Uquard, rotation: char, char_grid: &CharGrid, hash_set: &mut Vec<(Uquard,char)>) -> bool {
    if!(REF_CHECKED_POSITIONS.contains(&char_grid.index_usize(position))){
        print!("{position:?}")
    };
    hash_set.clear();
    let mut current_position = position;
    // println!();
    // print!("initial:({rotation})");
    let mut current_rotation = rotate_90_cw(rotation);
    loop {
        match get_next_guard(current_position, current_rotation, char_grid) {
            None => { return false; },
            Some(next_guard) => {
                if next_guard.1 == '#' {
                    if hash_set.contains(&(current_position,current_rotation)) {
                        return true;
                    } else {hash_set.push((current_position,current_rotation));}
                    current_rotation = rotate_90_cw(current_rotation);
                } else {
                    current_position = next_guard.0;
                }
            }
        }
    }
}

// #[allow(dead_code)]
// fn debug_print_traversal_loops(position: Uquard, rotation: char, char_grid: &mut CharGrid) -> bool {
//     let mut current_position = position;
//     // println!();
//     // print!("initial:({rotation})");
//     let mut current_rotation = rotate_90_cw(rotation);
//     loop {
//         let current_char = char_grid.index_mut(current_position).unwrap();
//         let old_char = *current_char;
//         *current_char = '%';
//         char_grid.debug_print();
//         let current_char = char_grid.index_mut(current_position).unwrap();
//         *current_char = old_char;
//
//         // print!("{current_rotation}{current_position:?}");
//         match get_next_guard_position(current_position, current_rotation) {
//             None => { return false; },
//             Some(next_guard_postion) => {
//                 match char_grid.index(next_guard_postion) {
//                     None => { return false; },
//                     Some(next_guard_char) => {
//                         if next_guard_char == &'#' {
//                             current_rotation = rotate_90_cw(current_rotation);
//                         } else {
//                             current_position = next_guard_postion;
//                         }
//                     }
//                 }
//             }
//         }
//         if current_position == position && current_rotation == rotation {
//             return true;
//         }
//     }
// }

fn rotate_90_cw(guard_rotation: char) -> char {
    match guard_rotation {
        '^' => '>',
        '>' => 'v',
        'v' => '<',
        '<' => '^',
        _ => unreachable!()
    }
}

fn get_next_guard(guard_position: Uquard, guard_rotation: char, char_grid: &CharGrid) -> Option<(Uquard, char)> {
    let next_position = get_next_guard_position(guard_position, guard_rotation);
    match next_position {
        None => None,
        Some(next_position) => {
            (char_grid.index(next_position)).map(|char| (next_position, *char))
        }
    }
}
fn get_next_guard_position_mut(guard_position: Uquard, guard_rotation: char, char_grid: &mut CharGrid) -> Option<(Uquard, &mut char)> {
    let next_position = get_next_guard_position(guard_position, guard_rotation);
    match next_position {
        None => None,
        Some(next_position) => {
            (char_grid.index_mut(next_position)).map(|char| (next_position, char))
        }
    }
}

fn get_next_guard_position(guard_position: Uquard, guard_rotation: char) -> Option<Uquard> {
    match guard_rotation {
        '^' => guard_position - Uquard(0, 1),
        '>' => Some(guard_position + Uquard(1, 0)),
        'v' => Some(guard_position + Uquard(0, 1)),
        '<' => guard_position - Uquard(1, 0),
        _ => { unreachable!() },
    }
}

#[allow(unused)]
const TEST_INPUT: &str = include_str!("day6_test.txt");
#[cfg(test)]
mod tests {
    use crate::problems::day6::{part1, part2, TEST_INPUT};

    #[test]
    fn day6_part1() {
        assert_eq!(part1(TEST_INPUT), 41);
    }

    #[test]
    fn day6_part2() {
        assert_eq!(part2(TEST_INPUT), 6);
    }
}